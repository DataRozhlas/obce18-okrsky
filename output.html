<div class="b-data__content" id="content">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
<script src="https://ft-polyfill-service.herokuapp.com/v2/polyfill.min.js?features=Object.values,String.prototype.startsWith"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/openlayers/4.6.4/ol-debug.js"></script>

<script type="text/javascript">document.getElementsByTagName('article')[0].classList.add('b-data--no-img');</script>
<link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/openlayers/4.6.4/ol.css">
<style>.zasttype{margin-left:5px}#tooltip{min-height:80px}</style>
<div class="row-main row-main--article">
<h1 class="b-data__title b-data__title--sm">
Koho volili vaši sousedi? Prohlédněte si nejpodrobnější mapu výsledků prvního kola prezidentské volby
</h1>
</div>
<div class="row-main row-main--narrow">
<p class="text-bold text-lg">Miloš Zeman zvítězil ve všech krajích s výjimkou Prahy. Detailnější pohled na volební mapu ovšem ukazuje pestřejší obrázek: Jiří Drahoš výrazně bodoval v centrech větších měst, ale také v okolí rodného Jablunkova nebo v horských střediscích. A jak to dopadlo u vás?</p>
<p class="meta meta--icon">
	<span class="icon-svg icon-svg--bullet">
	<svg class="icon-svg__svg" xmlns:xlink="http://www.w3.org/1999/xlink">
		<use xlink:href="https://www.irozhlas.cz/sites/all/themes/custom/irozhlas/img/bg/icons-svg.svg#icon-bullet" x="0" y="0" width="100%" height="100%"></use>
	</svg>
</span>

	<strong>Praha</strong> <time>13. ledna 2018</time>
</p>



<p></div><div class="row-main row-main--article">
<div id="mapdiv">
    <div id="select"></div>
    <form>
        <input type="radio" class="zasttype" name="zasttype" value="obce" checked="checked">Zastupitelstva obcí a magistráty
        <input type="radio" class="zasttype" name="zasttype" id="zastcheck" value="mcmo">Zastupitelstva městských částí
        </form>
    <div id="tooltip">Myší vyberte obec.</div>
    <div id="map" class="map"></div>
     <form action="?" id='frm-geocode'>
      <label for="inp-geocode">Najít adresu</label>
      <div class="inputs">
        <input type="text" id="inp-geocode" placeholder="Bruntál">
        <input type="submit" value="Najít">
      </div>
    </form>
</div>
</div><div class="row-main row-main--narrow"></p>

<p class="meta meta--right meta--big">
<strong><a href="#" class="meta__link">Jan Cibulka a Petr Kočí</a></strong>
</p>
</div>
<!--[[ZPRAVY_SNOWFALL_RELATED:ARTICLES]]-->
</div>
</article>
</div>
</div>
</div><script>var breaks={"HL_KDU-ČSL":[0.05670103092783505,0.1826086956521739,0.3611111111111111,0.7045454545454546],"HL_KSČM":[0.03835730664998958,0.10704225352112676,0.2037037037037037,0.4],"HL_ČSSD":[0.0463703229932843,0.12719298245614036,0.27807486631016043,0.6428571428571429],"HL_ODS":[0.049358341559723594,0.1409090909090909,0.2903225806451613,0.6590909090909091],"HL_ANO":[0.031151667715544368,0.08626198083067092,0.15,0.33974358974358976],"HL_STAN":[0.04272151898734177,0.1574279379157428,0.3625,0.6904761904761905],"HL_SPD":[0.02358490566037736,0.06493506493506493,0.09944751381215469,0.14955357142857142],"HL_TOP 09":[0.033363390441839495,0.10115606936416185,0.26785714285714285,0.5517241379310345],"HL_Piráti":[0.0,0.06103286384976526,0.09100418410041841,0.13432835820895522],"HL_Ostatní":[0.1111111111111111,0.23076923076923078,0.4090909090909091,0.75],"UCAST":[4.680851063829787,10.642857142857142,18.03125,26.49411764705882],};var okresy={'Hlaví město Praha':'1100','Benešov':'2101','Beroun':'2102','Kladno':'2103','Kolín':'2104','Kutná Hora':'2105','Mělník':'2106','Mladá Boleslav':'2107','Nymburk':'2108','Praha-východ':'2109','Praha-západ':'2110','Příbram':'2111','Rakovník':'2112','České Budějovice':'3101','Český Krumlov':'3102','Jindřichův Hradec':'3103','Písek':'3104','Prachatice':'3105','Strakonice':'3106','Tábor':'3107','Domažlice':'3201','Klatovy':'3202','Plzeň-město':'3203','Plzeň-jih':'3204','Plzeň-sever':'3205','Rokycany':'3206','Tachov':'3207','Cheb':'4101','Karlovy Vary':'4102','Sokolov':'4103','Děčín':'4201','Chomutov':'4202','Litoměřice':'4203','Louny':'4204','Most':'4205','Teplice':'4206','Ústí nad Labem':'4207','Česká Lípa':'5101','Jablonec nad Nisou':'5102','Liberec':'5103','Semily':'5104','Hradec Králové':'5201','Jičín':'5202','Náchod':'5203','Rychnov nad Kněžnou':'5204','Trutnov':'5205','Chrudim':'5301','Pardubice':'5302','Svitavy':'5303','Ústí nad Orlicí':'5304','Havlíčkův Brod':'6101','Jihlava':'6102','Pelhřimov':'6103','Třebíč':'6104','Žďár nad Sázavou':'6105','Blansko':'6201','Brno-město':'6202','Brno-venkov':'6203','Břeclav':'6204','Hodonín':'6205','Vyškov':'6206','Znojmo':'6207','Jeseník':'7101','Olomouc':'7102','Prostějov':'7103','Přerov':'7104','Šumperk':'7105','Kroměříž':'7201','Uherské Hradiště':'7202','Vsetín':'7203','Zlín':'7204','Bruntál':'8101','Frýdek-Místek':'8102','Karviná':'8103','Nový Jičín':'8104','Opava':'8105','Ostrava-město':'8106'};var hst='https://data.irozhlas.cz/obce18-okrsky';if(window.location.hostname=='localhost'){hst='./scratch/'};var isFirefox=typeof InstallTrigger!=='undefined';var isIE=false||!!document.documentMode;var isEdge=!isIE&&!!window.StyleMedia;var partyCols={'ČSSD':'#ff7f00','ODS':'#1f78b4','KSČM':'#e31a1c','Piráti':'black','SPD':'#a6cee3','KDU-ČSL':'#ffff99','STAN':'darkgray','ANO':'#cab2d6','TOP 09':'#6a3d9a','Ostatní':'lightgray'};var selCont='<select><option value="HL_OKRS">Vítězové v okrscích</option>'
+'<option value="UCAST">Účast</option>'
Object.keys(partyCols).forEach(function(e){selCont+='<option value="HL_'+e+'">'+e+'</option>'});selCont+='</select>'
$('#select').html(selCont)
function orderWinners(props){var out={};Object.keys(props).forEach(function(key){if(partyCols.hasOwnProperty(key.split('_')[1])){out[key.split('_')[1]]=props[key];};});return Object.keys(out).sort(function(a,b){return out[b]-out[a]});};function getColor(props,party){var col;if(party=='HL_OKRS'){var win=orderWinners(props);col=partyCols[win[0]]||'rgba(242,240,247, 1';}else if(party=='UCAST'){var val=props['PLATNE_HLASY']/props['ZAPSANI_VOLICI']
if(val<=breaks[party][0]){col='rgba(242,240,247, 0.7)'}else
if(val<=breaks[party][1]){col='rgba(203,201,226, 0.7)'}else
if(val<=breaks[party][2]){col='rgba(158,154,200, 0.7)'}else
if(val<=breaks[party][3]){col='rgba(117,107,177, 0.7)'}else
if(val>breaks[party][3]){col='rgba(84,39,143, 0.7)'}else
{col='rgba(242,240,247, 1'}}else{var val=props[party]/props['PLATNE_HLASY']
if(val<=breaks[party][0]){col='rgba(254,240,217, 0.7)'}else
if(val<=breaks[party][1]){col='rgba(253,204,138, 0.7)'}else
if(val<=breaks[party][2]){col='rgba(252,141,89, 0.7)'}else
if(val<=breaks[party][3]){col='rgba(215,48,31, 0.7)'}else
if(val>breaks[party][3]){col='rgba(215,48,31, 0.7)'}else
{col='rgba(242,240,247, 1'}}
var style=new ol.style.Style({stroke:new ol.style.Stroke({color:"lightgray",width:0.3}),fill:new ol.style.Fill({color:col})})
return style;};function makeTooltip(party,evt){var blabol='<b>Okrsek č. '+evt['Cislo']+', '+(evt['Momc']||evt['Obec'])+'</b>, okres '+evt['Okres']+'<br>'
if(typeof evt['PLATNE_HLASY']=='undefined'){blabol+='Ve vojenských újezdech volby neprobíhají.'}else if(party=='UCAST'){blabol+='Účast zde byla '+Math.round((evt['ODEVZDANE_OBALKY']/evt['ZAPSANI_VOLICI'])*1000)/10+' %.'}else if(party=='HL_OKRS'){var win=orderWinners(evt);for(var key in win){if(evt['HL_'+win[key]]>0){blabol+='<b><span style="color: '+partyCols[win[key]].replace('.7','1')+';">'+win[key]+'</span></b> ('+evt['HL_'+win[key]]+' hl., '
+Math.round((evt['HL_'+win[key]]/evt['PLATNE_HLASY'])*1000)/10+' %); '}}}else{blabol+='Strana '+party.split('_')[1]+' zde získala '+Math.round((evt[party]/evt['PLATNE_HLASY'])*1000)/10+' % hlasů (z celkem '
+evt['PLATNE_HLASY']+').'}
document.getElementById('tooltip').innerHTML=blabol};var tilegrid=ol.tilegrid.createXYZ({tileSize:512,maxZoom:15});var background=new ol.layer.Tile({source:new ol.source.TileImage({url:'https://interaktivni.rozhlas.cz/tiles/ton_b1/{z}/{x}/{y}.png',attributions:[new ol.Attribution({html:'obrazový podkres <a target="_blank" href="http://stamen.com">Stamen</a>, <a target="_blank" href="https://samizdat.cz">Samizdat</a>, data <a target="_blank" href="https://www.czso.cz/csu/czso/uchazeci-o-zamestnani-dosazitelni-a-podil-nezamestnanych-osob-podle-obci">ČSÚ</a>'})]})})
var labels=new ol.layer.Tile({source:new ol.source.TileImage({url:'https://interaktivni.rozhlas.cz/tiles/ton_l1/{z}/{x}/{y}.png',maxZoom:15})})
function drawMap(party,mustMomc){$('#map').empty()
var layer=new ol.layer.VectorTile({source:new ol.source.VectorTile({format:new ol.format.MVT(),tileGrid:tilegrid,tilePixelRatio:8,url:hst+'tiles/{z}/{x}/{y}.pbf'}),style:function(feature){if(mustMomc&(feature.properties_.isMomc==false)){return null}else{return getColor(feature.properties_,party)}}});var initZoom;if(window.innerWidth<768){initZoom=6;document.getElementById('tooltip').innerHTML='Kliknutím vyberte obec.'}else{initZoom=7;}
var map=new ol.Map({interactions:ol.interaction.defaults({mouseWheelZoom:false}),target:'map',view:new ol.View({center:ol.proj.transform([15.3350758,49.7417517],'EPSG:4326','EPSG:3857'),zoom:initZoom,minZoom:6,maxZoom:15})});map.addLayer(background);map.addLayer(layer);map.addLayer(labels);if(!(isEdge|isFirefox|isIE)){map.on('pointermove',function(evt){if(evt.dragging){return;}
var pixel=map.getEventPixel(evt.originalEvent);if(map.hasFeatureAtPixel(pixel)){map.forEachFeatureAtPixel(pixel,function(feature,layer){makeTooltip(party,feature.properties_);});}else{document.getElementById('tooltip').innerHTML='Myší vyberte obec.'}});map.on('singleclick',function(evt){var pixel=map.getEventPixel(evt.originalEvent);if(map.hasFeatureAtPixel(pixel)){map.forEachFeatureAtPixel(pixel,function(feature){window.open('https://volby.cz/pls/kv2018/kv1111?xjazyk=CZ&xid=1&xdz=1&xnumnuts='
+okresy[feature.properties_.Okres]
+'&xobec='
+feature.properties_.okid.split('_')[0]
+'&xokrsek='
+feature.properties_.okid.split('_')[1]
+'&xstat=0&xvyber=0','_blank');});}});};map.on('singleclick',function(evt){var pixel=map.getEventPixel(evt.originalEvent);if(map.hasFeatureAtPixel(pixel)){map.forEachFeatureAtPixel(pixel,function(feature){makeTooltip(party,feature.properties_);});}else{document.getElementById('tooltip').innerHTML='Kliknutím vyberte obec.'}});var form=document.getElementById("frm-geocode");var geocoder=null;var geocodeMarker=null;form.onsubmit=function(event){event.preventDefault();var text=document.getElementById("inp-geocode").value;if(text==''){map.getView().setCenter(ol.proj.transform([15.3350758,49.7417517],'EPSG:4326','EPSG:3857'))
map.getView().setZoom(8)}else{$.get("https://api.mapy.cz/geocode?query="+text,function(data){if(typeof $(data).find('item').attr('x')=='undefined'){alert("Bohužel, danou adresu nebylo možné najít");return;}
var x=parseFloat($(data).find('item').attr('x'))
var y=parseFloat($(data).find('item').attr('y'))
map.getView().setCenter(ol.proj.transform([x,y],'EPSG:4326','EPSG:3857'))
map.getView().setZoom(12)},'xml');}};};drawMap('HL_OKRS',false)
var selMcmo=false;var selType='HL_OKRS';$('#select').on('change',function(){selType=$(this).find(":selected").val();drawMap(selType,selMcmo);});$('.zasttype').change(function(){selMcmo=document.getElementById('zastcheck').checked;drawMap(selType,selMcmo);});</script>
